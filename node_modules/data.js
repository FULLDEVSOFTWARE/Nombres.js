document.addEventListener('DOMContentLoaded', function () {
  const formulario = document.getElementById('miFormulario');
  const resultado = document.getElementById('resultado');
  let editIndex = -1;

  // Registros predefinidos (solo si localStorage está vacío)
  if (!localStorage.getItem('registros')) {
    const registrosIniciales = [
      { nombre: 'Ana Torres', correo: 'ana@example.com', id: '101' },
      { nombre: 'Luis Pérez', correo: 'luis@example.com', id: '102' },
      { nombre: 'María López', correo: 'maria@example.com', id: '103' }
    ];
    localStorage.setItem('registros', JSON.stringify(registrosIniciales));
  }

  mostrarRegistros();

  formulario.addEventListener('submit', function (e) {
    e.preventDefault();

    const nombre = document.getElementById('nombre').value;
    const correo = document.getElementById('correo').value;
    const id = document.getElementById('id').value;

    let registros = JSON.parse(localStorage.getItem('registros')) || [];

    if (editIndex === -1) {
      // Agregar nuevo registro
      registros.push({ nombre, correo, id });
    } else {
      // Editar registro existente
      registros[editIndex] = { nombre, correo, id };
      editIndex = -1;
    }

    localStorage.setItem('registros', JSON.stringify(registros));
    formulario.reset();
    mostrarRegistros();
  });

  function mostrarRegistros() {
    let registros = JSON.parse(localStorage.getItem('registros')) || [];
    resultado.innerHTML = "<h3>Registros guardados:</h3>";

    registros.forEach((registro, index) => {
      resultado.innerHTML += `
        <p><strong>Registro ${index + 1}</strong><br>
        Nombre: ${registro.nombre}<br>
        Correo: ${registro.correo}<br>
        ID: ${registro.id}</p>
        <button onclick="editarRegistro(${index})">Editar</button>
        <button onclick="eliminarRegistro(${index})">Eliminar</button>
        <hr>
      `;
    });
  }

  window.editarRegistro = function(index) {
    let registros = JSON.parse(localStorage.getItem('registros')) || [];
    const registro = registros[index];

    document.getElementById('nombre').value = registro.nombre;
    document.getElementById('correo').value = registro.correo;
    document.getElementById('id').value = registro.id;

    editIndex = index;
  }

  window.eliminarRegistro = function(index) {
    let registros = JSON.parse(localStorage.getItem('registros')) || [];
    registros.splice(index, 1); 
    localStorage.setItem('registros', JSON.stringify(registros));
    mostrarRegistros();
  }
});

